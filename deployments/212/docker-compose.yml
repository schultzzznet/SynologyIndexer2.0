services:
  motion-detector:
    build:
      context: ../..
      dockerfile: Dockerfile.arm
    container_name: motion-detection-viewer-212
    ports:
      - "5050:5050"
    volumes:
      - /mnt/nas-212/surveillance:/surveillance:ro  # Read-only surveillance footage
      - motion-db-212:/data  # Local volume for database (NOT on NAS!)
    environment:
      - SURVEILLANCE_ROOT=/surveillance
      - DEPLOYMENT_NAME=212
      - WORKERS=2
      - AUTOSCAN_INTERVAL=60
      - YOLO_MODEL=yolov8n.pt  # Fast model for initial scan
    networks:
      - motion-net-212
    deploy:
      resources:
        limits:
          memory: 4G
        reservations:
          memory: 2G
    restart: unless-stopped

volumes:
  motion-db-212:
    driver: local

networks:
  motion-net-212:
    driver: bridge
