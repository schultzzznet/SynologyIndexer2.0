services:
  motion-detector:
    build:
      context: ../..
      dockerfile: Dockerfile.arm
    container_name: motion-detection-viewer-213
    ports:
      - "5051:5050"
    volumes:
      - /mnt/nas-213/surveillance:/surveillance:ro  # Read-only surveillance footage
      - motion-db-213:/data  # Local volume for database (NOT on NAS!)
    environment:
      - SURVEILLANCE_ROOT=/surveillance
      - DEPLOYMENT_NAME=213
      - WORKERS=2
      - AUTOSCAN_INTERVAL=60
      - YOLO_MODEL=yolov8n.pt
    networks:
      - motion-net-213
    deploy:
      resources:
        limits:
          memory: 4G
        reservations:
          memory: 2G
    restart: unless-stopped

volumes:
  motion-db-213:
    driver: local

networks:
  motion-net-213:
    driver: bridge
